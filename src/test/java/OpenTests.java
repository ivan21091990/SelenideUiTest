import Pages.BankOpenStartPage;
import Pages.StartPageBrowser;
import io.qameta.allure.Description;
import org.testng.annotations.Test;
import utils.TestProperties;
import java.util.Properties;

import static com.codeborne.selenide.Condition.*;
import static com.codeborne.selenide.Selenide.*;
import static org.testng.Assert.assertTrue;

public class OpenTests {
    private static Properties properties = TestProperties.getInstance().getProperties();

    @Test
    @Description("Проверка корретности отображения курсов валют")
    public void checkCorrectDisplayConversionRate() {
        StartPageBrowser startPageBrowser = new StartPageBrowser();
        open(properties.getProperty("urlStart"));
        startPageBrowser.getSearchField().setValue("Открытие").pressEnter();
        startPageBrowser.getFirstElementAfterSearch().shouldHave(exist);
        startPageBrowser.getFirstElementAfterSearch().shouldHave(attribute("href", properties.getProperty("urlOpen")));
        startPageBrowser.getFirstElementAfterSearch().click();
        BankOpenStartPage bankOpenStartPage = new BankOpenStartPage();
        bankOpenStartPage.currencyRatesTable.scrollTo();
        assertTrue(bankOpenStartPage.getCurrencyExchangeRate("USD", "Продажи") > bankOpenStartPage.getCurrencyExchangeRate("USD", "Покупки"),
               "Курс USD 'Покупки' выше курса 'Продажи'");
        assertTrue(bankOpenStartPage.getCurrencyExchangeRate("EUR", "Продажи") > bankOpenStartPage.getCurrencyExchangeRate("EUR", "Покупки"),
                "Курс EUR 'Покупки' выше курса 'Продажи'");
    }
}